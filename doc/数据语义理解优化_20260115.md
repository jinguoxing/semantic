# 数据语义理解优化（20260115）

## 目标
- 缩短用户获取“结论与风险”的路径，减少长页滚动成本。
- 让规则证据与 AI 证据可解释、可追溯、可定位到字段。
- 评分结果更稳定，避免随机波动影响决策。

## 优化范围
### 1. 结果摘要与评分拆解
- 增加评分拆解条（命名、行为、口径、覆盖度）与占比提示。
- 通过率与风险等级并列展示，便于快速判断。
- 规则证据与 AI 证据分开呈现，避免混淆。

### 2. 证据链与字段跳转
- 证据链支持一键定位字段，自动滚动并高亮。
- 支持模糊匹配（精确/大小写忽略/包含），提升可用性。
- 无法匹配时禁用点击并灰显提示，避免误跳转。

### 3. 规则证据分组与折叠
- 规则证据分组展示：异常/冲突/命名/口径/覆盖度。
- 默认只展开重点分组，减少首屏高度。
- 增加“展开/收起”交互，便于快速扫视。

### 4. 评分与规则逻辑稳定性
- 规则 Gatekeeper 增强：tmp/bak/_rel 直接拒绝；log/detail 为 REVIEW 灰名单。
- 评分逻辑引入关键词与覆盖度加权，减少单维偏差。
- AI 评分改为稳定计算（基于对象名/字段/备注/域），避免随机波动。

## 交互流程
1) 用户进入语义理解结果页 → 看到结论摘要与评分拆解。
2) 点击证据链 → 自动定位字段并高亮。
3) 展开证据分组 → 查看具体规则证据与 AI 证据。
4) 证据不可定位时提示不可用状态。

## 数据结构调整
- `scoreBreakdown?`：评分拆解结构。
- `aiEvidenceItems?`：AI 证据条目集合（含权重与标签）。

## 相关实现位置
- 结果页：`src/views/DataSemanticUnderstandingView.tsx`
- 结论卡：`src/views/semantic/SemanticConclusionCard.tsx`
- 分析卡：`src/views/semantic/SemanticAnalysisCard.tsx`
- 深度分析：`src/views/semantic/DeepAnalysisTabs.tsx`
- 规则与评分：`src/logic/semantic/rules.ts`, `src/logic/semantic/scoring.ts`
- AI 评分：`src/services/mockAiService.ts`
- 类型：`src/types/semantic.ts`

## 后续可选优化
- 结果目录/锚点导航，减少长页滚动。
- 分组证据分页或虚拟滚动。
- 结论摘要支持导出（PDF/图片）。
