

# 企业级 AI 语义治理平台设计规范 (V2.3 终极版)

## 1. 核心设计哲学 (Core Philosophy)

本版本致力于完成从“被动元数据查看器”到**“主动式、游戏化治理助手”**的跨越。

1. **从“硬门槛”到“场景化体检” (Context-Aware Scans):** 不再用一把尺子衡量所有表。基于表类型（OLTP vs OLAP）应用不同的评分模板，视缺陷为“待优化项”而非“错误”。
2. **从“诊断报告”到“行动清单” (Actionable Insights):** 不止告诉用户问题在哪，更直接提供一键修复的入口。
3. **游戏化驱动 (Gamification):** 明确告知每项治理动作带来的收益（如：置信度提升具体数值），激励用户完成任务。
4. **严谨口径与闭环决策 (Rigorous & Closed-Loop):** 建立互斥的统计标准杜绝数据打架；建立可预览、可回滚、可沉淀的决策闭环，重建用户信任。

---

## 2. 全局关键定义与规则 (Global Rules)

### 2.1. 双主键视角 (Dual PK Perspective)

解决物理约束与业务语义冲突的核心机制。

* **物理主键 (Physical PK):** 数据库层面的约束。数仓环境中常缺失，不作为硬性扣分项，仅做状态展示。
* **语义主键 (Semantic ID):** 业务上唯一标识实体的字段（如 `user_id`）。这是治理的核心，必须识别并标记。

### 2.2. 互斥计数逻辑 (Mutually Exclusive Counting)

解决统计摘要数字对不上的问题。一个字段在摘要统计时，仅归属于其**最高优先级**的角色。

* **优先级顺序：** 标识符 (PK/FK) > 生命周期 (Time) > 状态 (State) > 普通业务属性 (Attribute)。

### 2.3. 敏感口径强一致性 (Consistent Security)

* **原则：** 表级安全信息必须是字段级信息的严格聚合。
* **规则：** 表级最高密级 = Max(字段密级)；表级 PII 标记 = Exists(任何 PII 字段)。

---

## 3. 页面详细设计规范 (Detailed Specifications)

### 页面一：综合语义结论页 (The Decision Page, 图5重构)

**核心目标：** 将静态的“低置信度原因”转化为动态的“置信度提升任务清单”，并实现术语命名的最小闭环。

#### 3.1. [重构] 置信度分析与提升任务 (Confidence Boosting Tasks)

废弃纯文本原因列表，改为带有预期收益的行动任务表。

**UI 设计规范：**

> **🤖 AI 置信度：0.69 (存疑 ⚠️)**
> **【提升置信度建议清单】 (完成以下动作可显著提升 AI 判断准确率)**
> | 影响因子 | 状态 | 建议动作 (Actionable Links) | 预计提升 (Gamification) |
> | --- | --- | --- | --- |
> | **字段注释** | 🔴 覆盖率低 (20%) | [✨ **批量生成注释建议**] (AI 基于字段名生成, 需人工确认) | <span style="color:green">↑ 约 0.12</span> |
> | **主键语义** | 🔴 未识别到语义主键 | [🔗 **指定语义主键**] (跳转至详情页勾选唯一标识符) | <span style="color:green">↑ 约 0.08</span> |
> | **特殊字段** | 🟠 存在未知类型 (`ext_data`) | [🔍 **识别 JSON 结构**] / [🚫 **标记为扩展字段**] | <span style="color:green">↑ 约 0.05</span> |
> | **时间维度** | 🟢 生命周期完整 | (已检测到创建/更新时间) | - |
> 
> 

**交互逻辑：**

* 点击行动链接，应触发相应的弹窗（如批量注释确认）或页面跳转锚点定位（如跳转到详情页字段列表）。

#### 3.2. [新增] 术语命名最小闭环 (Term Naming Loop)

**UI 设计规范：**

* **组件：** “业务名称”输入框改为带联想功能的 **AutoComplete** 控件。
* **冷启动：** 预填灰色文字，如 “用户基础信息表 (AI建议)”。
* **复用优先：** 用户输入时，优先下拉展示标准术语库中已存在的词条，并打上醒目的 **[标准术语]** 标签。
* **沉淀机制：** 若用户输入全新名称并确认，系统后台自动将其沉淀为新术语，供后续复用。

#### 3.3. [保留与优化] 证据仪表盘 (Evidence Dashboard)

* 保持三栏平铺展示（生命周期、质量画像、安全合规）。
* **优化：** 安全合规卡片必须严格遵循“强一致性”原则，显示最高密级和 PII 字段来源透视。

---

### 页面二：语义理解结果审核页 (The Audit Modal, 图6重构)

**核心目标：** 提供严谨统一的统计摘要，并建立可预测、可回滚的升级决策闭环。

#### 4.1. [重构] 标准化三项统计摘要 (Unified Summary)

废弃原有混乱的计数，采用互斥、清晰的三维度指标。

**UI 设计规范 (置于弹窗顶部)：**

> **📋 审核摘要 (共扫描 12 个字段)**
> *注：基于互斥口径统计，确保总数匹配。*
> | 维度 | 指标值 | 说明 | 操作 |
> | --- | --- | --- | --- |
> | **① 字段识别覆盖率** | **83%** (10/12) | 已明确识别出语义角色的字段占比。 | [展开详情 ↓] |
> | **② 关键要素完整度** | ⚠️ **语义主键缺失** | 检查语义标识符、生命周期关键字段是否齐全。 | [去完善 →] |
> | **③ 风险项数量** | **3 项** | 包含：2 个敏感字段 (L3), 1 个未知类型字段。 | [查看风险 ↓] |
> 
> 

#### 4.2. [增强] 可预览、可回滚的升级建议流 (Upgrade Workflow)

针对 AI 的结构化升级建议，提供透明的决策支持。

**UI 设计规范 (升级建议卡片)：**

> **💡 升级建议：将此表升级为逻辑「行为对象」**
> *AI 依据：检测到此表包含时间序列和不可变数据特征。*
> **[👓 预览变更 (Preview)]** | **[✅ 接受建议]** | **[❌ 拒绝]** | **[🕒 稍后]**

**交互逻辑：**

* **预览 (Preview)：** 点击弹出模态窗，展示 **Before/After** 对比（如：将创建什么新对象，字段如何映射）。
* **拒绝 (Reject)：** 点击弹出简易理由选择框（识别错误/暂不需要），用于回馈优化模型。
* **回滚 (Rollback)：** (后台能力支持) 在操作日志中提供撤销按钮，确保操作可逆。

---

### 页面三：语义理解引擎详情页 (The Details Page, 图7重构)

**核心目标：** 落地“双主键”视角，增强质量评分的可解释性，并实现标识符的知识链接。

#### 5.1. [重构] 评分透视面板 (Scoring Breakdown)

废弃“未通过项警告条”，改为基于场景的评分透视。

**UI 设计规范：**

> **当前评分策略：DWS 汇总宽表标准 (重点考核语义清晰度)**
> | 考核维度 | 得分 | 诊断结果与修复建议 (Fix Path) |
> | --- | --- | --- |
> | **业务注释** | 30/50 | ⚠️ **注释覆盖率不足**。*建议：补充关键指标字段注释。* |
> | **物理主键** | 0/20 | ℹ️ **未检测到物理主键**。*（注：汇总表不强制，但建议指定逻辑主键）* |
> 
> 

#### 5.2. [增强] 字段列表的三维展示 (3D Field List)

**UI 设计规范：**

* **语义角色的链接化：**
* 将 `标识符` 文本改为 **蓝色链接按钮** 样式：`🔗 标识符 (指向: 用户主体)`。点击跳转至逻辑实体页。


* **安全等级的视觉警示：**
* L2/L3/L4 等级必须使用带 **🔒 小锁图标** 的彩色胶囊（橙色/红色）。


* **质量评分的 Hover 透视：**
* 鼠标悬停在评分方块（如 🅰️）上时，弹出浮层显示明细：`空值率: 0% | 唯一性: 100%`。



---

## 4. 后端 API 需求摘要 (Backend Requirements)

为了支撑前端 V2.3 的特性，后端需要提供以下能力：

1. **置信度提升预估 API：** 返回每个待修复项的预计分数提升值。
2. **术语联想与沉淀 API：** 支持已有标准术语的模糊检索，以及新术语的创建接口。
3. **升级预览 Diff API：** 返回接受升级建议前后的元数据差异结构 (Before/After)。
4. **互斥统计摘要 API：** 按照定义的优先级逻辑，返回准确的字段统计摘要。