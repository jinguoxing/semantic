# 语义版本管理 v2.4 功能清单与任务拆解

基于 `2.4figma.md` 与 `2.4实施计划.md` 的落地拆解，面向产品/设计/前端/后端对齐。

---

## 1. 功能清单（What）

### 1.1 版本列表页（Semantic Version List）
- 版本列表展示（版本号、状态、范围、对象数、字段数、质量规则数、安全策略数、发布时间）
- 过滤与搜索（状态/范围/创建人/发布时间）
- 行操作：查看详情、Diff、发布/回滚
- 新建版本（草稿）入口

### 1.2 版本详情页（Semantic Version Detail）
- Header：版本号/状态/范围/基线版本/发布时间/发布人
- Tabs：
  1) 对象快照（复用业务对象建模页）
  2) 字段语义快照（只读列表）
  3) 质量 & 安全快照（只读统计/入口）
  4) 下游绑定（消费方/绑定版本/切换记录）
  5) 版本 Diff（对象/字段/质量/安全维度）

### 1.3 版本态与工作态切换（Version Context）
- 全局或页面级 Context
- 统一控制编辑能力（拖拽/编辑/保存/AI 操作）
- 只读徽标 + Tooltip 提示

---

## 2. 技术拆解（How）

### 2.1 新增页面与路由
- 新增 `SemanticVersionView`（列表 + 详情）
- `App.tsx` 增加 `semantic_version` 路由入口
- `Sidebar` 与 `Header` 文案对齐

### 2.2 关键类型与状态
- 新增 `SemanticVersion` 类型（Draft/Published/Deprecated/Rolled Back）
- 新增 `versionMode`：`working | version`
- 通过 Context 或 Props 下发 `readOnly` 与 `versionId`

### 2.3 组件复用改造
- `BusinessModelingView`
  - 增加 `readOnly?: boolean`, `versionId?: string`
  - 只读态禁用：新增/编辑/拖拽/保存
- `DataSemanticUnderstandingView`
  - 增加 `readOnly?: boolean`, `versionId?: string`
  - 只读态禁用：编辑/确认/写回

### 2.4 Mock 数据
- `mockSemanticVersions`（版本列表 + 快照数据）
- 版本 Diff 的变更数据（Added/Removed/Changed）

---

## 3. 任务分解（By Stage）

### 阶段一：框架与路由
- [x] 新建 `SemanticVersionView`（列表+详情骨架）
- [x] `App.tsx` 增加 `semantic_version` 路由
- [x] Header/Sidebar 文案与入口补齐

### 阶段二：对象快照（复用）
- [x] `BusinessModelingView` 增加 `readOnly` 适配
- [x] 版本态隐藏/禁用所有编辑能力
- [x] 版本快照标识组件（ReadonlyBadge）

### 阶段三：字段/质量/安全/绑定
- [x] 字段语义快照 Tab（只读列表 + 过滤）
- [x] 质量 & 安全快照 Tab（统计 + 详情入口）
- [x] 下游绑定 Tab（消费方列表 + 审计）

### 阶段四：Diff 与版本操作
- [x] 版本 Diff Tab（对象/字段/质量/安全）
- [ ] 发布/回滚交互与确认
- [ ] 版本态只读 CTA 规范

---

## 4. 测试/验收清单

### 列表页
- [x] 列表数据正确显示
- [ ] 筛选正确生效
- [x] 行操作可用

### 详情页
- [x] 对象快照只读
- [x] 字段语义快照只读
- [x] 质量/安全快照展示完整
- [x] 下游绑定展示完整

### 版本态控制
- [x] 所有编辑能力被禁用
- [x] 只读标识可见

---

## 5. 风险与依赖

- 依赖现有 `BusinessModelingView` 与 `DataSemanticUnderstandingView` 的可插拔性
- Diff 口径需与后端版本对齐
- 版本态上下文需覆盖所有可编辑入口
