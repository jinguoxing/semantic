# 逻辑视图列表页优化（数据字段与指标口径）

日期：2026-01-17

## 状态模型（统一口径）

### GovernanceStatus
- S0：未理解
- S1：建议已生成
- S3：已确认生效

说明：表级、字段级、对象级统一使用该状态。

## 列表字段（表级）

### 核心字段
- table：逻辑视图技术名
- comment：逻辑视图业务描述
- sourceId/sourceType：数据源信息
- governanceStatus：表级治理状态（S0/S1/S3）

### Run 快照（表级摘要）
- lastRun.runId：最近一次 run_id
- lastRun.status：运行状态（queued/running/success/failed）
- lastRun.startedAt/finishedAt
- lastRun.sampleRows
- lastRun.ruleVersion/modelVersion
- lastRun.queueInfo/estimateTime

### 治理驱动统计
- reviewStats.pendingReviewFields：待Review字段数
- reviewStats.gateFailedItems：门槛未通过数（Gate）
- reviewStats.riskItems：风险项数

S0 时以上三项为空，列表显示“—”。

## 指标口径（沿用现有规则）

### 1) 待Review字段数
构成：
- 规则 vs AI 角色冲突字段
- 敏感等级为 L3/L4 且未确认字段
- 低置信度字段（如已有置信度产出）

### 2) 门槛未通过数（Gate）
构成：
- Gatekeeper 未通过
- 缺失主键
- 缺失生命周期字段
- 命中排除表规则

### 3) 风险项数
构成：
- 融合分数低于阈值（沿用既有评分阈值）
- 敏感字段占比过高
- 冲突项数量超过阈值

备注：若无可量化阈值，则按现有规则输出的风险等级与冲突计数直接统计。

## Run 记录（全局）

### RunRecord 字段
- runId
- status（queued/running/success/failed）
- createdBy/createdAt
- startedAt/finishedAt
- tablesCount
- sampleRows
- ruleVersion/modelVersion
- queueInfo/estimateTime
- errorReason

### Run 与表级摘要关系
- RunRecord 为唯一事实源
- 表级快照仅保留最近一次 run 的摘要信息
- 列表展示使用表级摘要，详情追溯使用 runId

## 字段级状态（示例）

### FieldSemanticProfile
- governanceStatus：字段级治理状态（S0/S1/S3）
- sensitivity：敏感等级
- role/roleConfidence：语义角色与置信度

## 对象级状态（示例口径）
- 业务对象与映射只在 S3 后生效
- S1 阶段的对象仅为“候选/建议”

